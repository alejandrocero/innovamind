<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innovamind</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Estilo para una fuente más moderna */
        body {
            font-family: 'Inter', sans-serif;
        }
        .font-brand {
            font-family: 'Orbitron', sans-serif;
        }
        /* Para ocultar la barra de desplazamiento en el chat pero mantener la funcionalidad */
        #chat-messages::-webkit-scrollbar {
            width: 0;
            height: 0;
        }
        /* Efecto de brillo sutil */
        .neon-glow-cyan {
            box-shadow: 0 0 5px rgba(0, 229, 255, 0.5), 0 0 10px rgba(0, 229, 255, 0.3);
        }
        .neon-glow-pink {
            box-shadow: 0 0 5px rgba(255, 0, 255, 0.5), 0 0 10px rgba(255, 0, 255, 0.3);
        }
        /* Animación para el indicador de carga del bot */
        .bot-loading .animate-pulse-dot {
            animation: pulse 1.4s infinite ease-in-out both;
        }
        .bot-loading .animate-pulse-dot:nth-child(1) { animation-delay: -0.32s; }
        .bot-loading .animate-pulse-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes pulse {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-[#1a1a2e] font-sans text-gray-200">

    <!-- =========== SECCIÓN DE INICIO DE SESIÓN =========== -->
    <div id="login-page">
        <div class="min-h-screen flex items-center justify-center p-4">
            <div class="w-full max-w-6xl mx-auto bg-[#1f283e] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden border border-cyan-500/20">
                <div class="w-full md:w-1/2 p-8 sm:p-12 flex flex-col justify-center items-center">
                    <img 
                        src="http://googleusercontent.com/file_content/1" 
                        alt="[Ilustración de un robot amigable en un pasillo con luces de neón cian y magenta]"
                        class="rounded-lg shadow-lg object-cover w-full h-full"
                        onerror="this.onerror=null;this.src='https://placehold.co/600x400/1f283e/ffffff?text=Bienvenido';"
                    />
                </div>
                <div class="w-full md:w-1/2 p-8 sm:p-12 bg-[#1a1a2e] flex flex-col justify-center">
                    <h2 class="text-3xl font-bold text-white mb-8 text-center font-brand">INICIAR SESIÓN</h2>
                    <div class="space-y-6">
                        <div>
                            <label class="text-sm font-light text-cyan-400" for="username">Usuario</label>
                            <input id="username" type="text" placeholder="Escribe tu nombre de usuario" class="w-full mt-2 p-3 bg-cyan-500/10 rounded-lg border border-cyan-500/30 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-all"/>
                        </div>
                        <div>
                            <label class="text-sm font-light text-cyan-400" for="password">Contraseña</label>
                            <input id="password" type="password" placeholder="Escribe tu contraseña" class="w-full mt-2 p-3 bg-cyan-500/10 rounded-lg border border-cyan-500/30 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-all"/>
                        </div>
                    </div>
                    <button id="login-btn" class="w-full mt-10 p-4 bg-cyan-500 text-white font-bold rounded-lg hover:bg-cyan-400 transition-colors duration-300 text-lg neon-glow-cyan">
                        Entrar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- =========== SECCIÓN DEL QUIZ =========== -->
    <div id="quiz-page" class="hidden">
        <div class="min-h-screen flex flex-col items-center justify-center p-4">
            <div class="w-full max-w-2xl mx-auto text-center">
                <h2 class="text-3xl font-bold text-cyan-400 mb-4">Quiz de Diagnóstico</h2>
                <p class="text-gray-400 mb-8">Responde unas preguntas para personalizar tu experiencia.</p>
                <div id="quiz-container" class="bg-[#1f283e]/80 p-8 rounded-2xl shadow-lg border border-cyan-500/20">
                    <!-- Las preguntas del quiz se insertarán aquí -->
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2.5 mt-8">
                    <div id="progress-bar" class="bg-cyan-500 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- =========== SECCIÓN DE RECOMENDACIONES =========== -->
    <div id="recommendations-page" class="hidden">
        <div class="min-h-screen flex flex-col items-center justify-center p-4 text-center">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">¡Tus Cursos Recomendados!</h2>
            <p class="text-gray-400 mb-8 max-w-2xl">Basado en tus respuestas, creemos que estos cursos son el mejor punto de partida para ti.</p>
            <div id="recommendations-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- Las recomendaciones se insertarán aquí -->
            </div>
            <button id="continue-to-dashboard-btn" class="p-4 bg-cyan-500 text-white font-bold rounded-lg hover:bg-cyan-400 transition-colors duration-300 text-lg neon-glow-cyan">
                Explorar todos los cursos
            </button>
        </div>
    </div>

    <!-- =========== SECCIÓN DEL PANEL PRINCIPAL (DASHBOARD) =========== -->
    <div id="dashboard-page" class="hidden">
        <div class="min-h-screen text-white p-4 sm:p-6 lg:p-8">
            <div class="max-w-7xl mx-auto">
                <header class="flex flex-col sm:flex-row justify-between items-center mb-8">
                    <h1 class="text-4xl font-brand mb-4 sm:mb-0 text-cyan-400">Innovamind</h1>
                    <div class="w-full sm:w-auto flex items-center space-x-4 relative">
                        <div class="relative flex-grow sm:flex-grow-0">
                            <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-cyan-400/60 w-5 h-5"></i>
                            <input type="text" placeholder="¿Cómo te podemos ayudar?" class="w-full sm:w-64 lg:w-80 pl-10 pr-4 py-2 bg-cyan-500/10 rounded-lg border border-cyan-500/30 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400"/>
                        </div>
                        <div class="relative">
                            <button id="notifications-btn" class="p-2 rounded-full hover:bg-cyan-500/20 transition-colors relative">
                                <i data-lucide="bell" class="w-5 h-5 text-cyan-400"></i>
                                <span id="notification-dot" class="absolute top-1 right-1 block h-2 w-2 rounded-full bg-pink-500 neon-glow-pink"></span>
                            </button>
                            <div id="notifications-panel" class="hidden absolute top-full right-0 mt-2 w-80 bg-[#2a3650] rounded-lg shadow-2xl border border-cyan-500/20 text-white z-10 md:w-96">
                                <div class="p-3 border-b border-cyan-500/20"><h3 class="font-bold text-cyan-400">Notificaciones</h3></div>
                                <div id="notification-list" class="p-1 max-h-96 overflow-y-auto"></div>
                            </div>
                        </div>
                        <button id="profile-btn" class="p-2 rounded-full hover:bg-cyan-500/20 transition-colors" title="Ver Perfil"><i data-lucide="user-circle" class="w-5 h-5 text-cyan-400"></i></button>
                        <button class="logout-btn p-2 rounded-full hover:bg-cyan-500/20 transition-colors" title="Cerrar Sesión"><i data-lucide="log-out" class="w-5 h-5 text-pink-500"></i></button>
                    </div>
                </header>
                <div class="mb-12">
                    <h2 class="text-4xl font-light">¡Hola <span class="font-semibold text-cyan-400">Innovador</span>!</h2>
                    <p class="text-xl text-gray-400">Bienvenido(a) a tu espacio</p>
                </div>
                <div>
                    <h3 id="dashboard-title" class="text-2xl font-bold mb-6 text-cyan-400">Cursos</h3>
                    <div id="app-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-4 sm:gap-6"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- =========== SECCIÓN DE PERFIL =========== -->
    <div id="profile-page" class="hidden">
        <div class="min-h-screen text-white p-4 sm:p-6 lg:p-8">
            <div class="max-w-4xl mx-auto">
                <header class="flex items-center justify-between mb-10">
                    <button class="back-to-dashboard-btn flex items-center gap-2 text-cyan-400/80 hover:text-cyan-400 transition-colors"><i data-lucide="arrow-left" class="w-5 h-5"></i> Volver al Panel</button>
                    <h1 class="text-3xl font-brand text-cyan-400">Perfil y Configuración</h1>
                    <div class="w-24"></div>
                </header>
                <div class="bg-[#1f283e]/80 p-8 rounded-2xl shadow-lg border border-cyan-500/20">
                    <div class="flex flex-col sm:flex-row items-center sm:items-start text-center sm:text-left gap-6 mb-10">
                        <img src="https://placehold.co/128x128/1a1a2e/00e5ff?text=User" alt="[Avatar de usuario]" class="w-32 h-32 rounded-full border-4 border-cyan-500/30"/>
                        <div class="flex-grow">
                            <h2 class="text-3xl font-bold text-cyan-400">Innovador</h2>
                            <p class="text-gray-400">innovador.pro@email.com</p>
                            <button class="mt-4 px-4 py-2 text-sm bg-cyan-500/10 border border-cyan-500/30 rounded-lg hover:bg-cyan-500/20 transition-colors">Cambiar foto</button>
                        </div>
                    </div>
                    <div class="space-y-8">
                        <div>
                            <h3 class="text-xl font-semibold mb-4 border-b border-cyan-500/20 pb-2 text-cyan-400">Información Personal</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label class="text-sm font-light text-cyan-400/80" for="fullName">Nombre Completo</label><input id="fullName" type="text" value="Innovador Pro" class="w-full mt-2 p-3 bg-cyan-500/10 rounded-lg border border-cyan-500/30 text-white"/></div>
                                <div><label class="text-sm font-light text-cyan-400/80" for="email">Correo Electrónico</label><input id="email" type="email" value="innovador.pro@email.com" class="w-full mt-2 p-3 bg-cyan-500/10 rounded-lg border border-cyan-500/30 text-white"/></div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-4 border-b border-cyan-500/20 pb-2 text-cyan-400">Seguridad</h3>
                            <div class="space-y-4">
                               <button class="flex items-center gap-3 w-full text-left p-3 rounded-lg hover:bg-cyan-500/10 transition-colors"><i data-lucide="key-round" class="text-cyan-400/70"></i><span>Cambiar Contraseña</span></button>
                               <button class="flex items-center gap-3 w-full text-left p-3 rounded-lg hover:bg-cyan-500/10 transition-colors"><i data-lucide="bell" class="text-cyan-400/70"></i><span>Gestionar Notificaciones</span></button>
                               <button class="flex items-center gap-3 w-full text-left p-3 rounded-lg hover:bg-cyan-500/10 transition-colors"><i data-lucide="palette" class="text-cyan-400/70"></i><span>Apariencia y Tema</span></button>
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-col sm:flex-row items-center justify-between mt-12 pt-8 border-t border-cyan-500/20">
                        <button class="logout-btn w-full sm:w-auto text-center px-6 py-3 text-pink-500 hover:bg-pink-500/20 rounded-lg transition-colors order-2 sm:order-1 mt-4 sm:mt-0">Cerrar Sesión</button>
                        <button class="w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 bg-cyan-500 text-white font-bold rounded-lg hover:bg-cyan-400 transition-colors order-1 sm:order-2"><i data-lucide="save" class="w-5 h-5"></i>Guardar Cambios</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- =========== SECCIÓN DE SUBCATEGORÍAS =========== -->
    <div id="subcategory-page" class="hidden">
        <div class="min-h-screen text-white p-4 sm:p-6 lg:p-8">
            <div class="max-w-4xl mx-auto">
                <header class="flex items-center justify-between mb-10">
                    <button class="back-to-dashboard-btn flex items-center gap-2 text-cyan-400/80 hover:text-cyan-400 transition-colors">
                        <i data-lucide="arrow-left" class="w-5 h-5"></i> Volver a Cursos
                    </button>
                </header>
                <div id="subcategory-container" class="bg-[#1f283e]/80 p-8 rounded-2xl shadow-lg border border-cyan-500/20">
                    <!-- El contenido de las subcategorías se insertará aquí -->
                </div>
            </div>
        </div>
    </div>

    <!-- =========== SECCIÓN DE CONTENIDO DE CURSO =========== -->
    <div id="content-page" class="hidden">
        <div class="min-h-screen text-white p-4 sm:p-6 lg:p-8">
            <div class="max-w-4xl mx-auto">
                <header class="flex items-center justify-between mb-10">
                    <button id="back-to-subcategories-btn" class="back-btn flex items-center gap-2 text-cyan-400/80 hover:text-cyan-400 transition-colors">
                        <i data-lucide="arrow-left" class="w-5 h-5"></i> Volver a Subcategorías
                    </button>
                </header>
                <div id="content-container" class="bg-[#1f283e]/80 p-8 rounded-2xl shadow-lg border border-cyan-500/20"></div>
            </div>
        </div>
    </div>
    
    <!-- =========== MODAL DE COMPLETADO =========== -->
    <div id="completion-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-[#2a3650] rounded-xl shadow-2xl p-8 text-center max-w-md border border-cyan-500/30">
            <div class="text-cyan-400 mb-4"><i data-lucide="party-popper" class="w-16 h-16 mx-auto"></i></div>
            <h3 class="text-2xl font-bold text-white mb-3">¡Felicidades!</h3>
            <p class="text-gray-300 mb-6">Has terminado el curso de Finanzas y Contabilidad.</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="download-sheet-btn" class="flex-1 p-3 bg-cyan-500 text-white font-bold rounded-lg hover:bg-cyan-400 transition-colors neon-glow-cyan">Descargar Hoja de Cálculo</button>
                <button id="close-modal-btn" class="flex-1 p-3 bg-pink-500/20 text-pink-400 font-bold rounded-lg hover:bg-pink-500/30 transition-colors">Cerrar</button>
            </div>
        </div>
    </div>


    <!-- =========== CHATBOT =========== -->
    <div id="chat-bubble" class="fixed bottom-5 right-5 bg-cyan-500 text-white p-4 rounded-full shadow-lg cursor-pointer hover:scale-110 transition-transform neon-glow-cyan"><i data-lucide="message-circle" class="w-8 h-8"></i></div>
    <div id="chat-window" class="hidden fixed bottom-24 right-5 w-80 sm:w-96 h-[500px] bg-[#2a3650] rounded-xl shadow-2xl flex flex-col transition-all duration-300 border border-cyan-500/30">
        <div class="p-4 bg-[#1f283e] rounded-t-xl flex justify-between items-center text-cyan-400"><h3 class="font-bold">Innovabot</h3><button id="close-chat-btn" class="hover:text-gray-300"><i data-lucide="x" class="w-6 h-6"></i></button></div>
        <div id="chat-messages" class="flex-grow p-4 overflow-y-auto flex flex-col space-y-3"></div>
        <form id="chat-form" class="p-3 border-t border-cyan-500/20 flex items-center gap-2">
            <input id="chat-input" type="text" placeholder="Habla con Innovabot..." class="flex-grow bg-cyan-500/10 p-2 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400">
            <button type="submit" class="bg-cyan-500 text-white p-2 rounded-full hover:bg-cyan-400"><i data-lucide="send" class="w-5 h-5"></i></button>
        </form>
    </div>

    <script>
        // --- ELEMENTOS DEL DOM ---
        const loginPage = document.getElementById('login-page');
        const dashboardPage = document.getElementById('dashboard-page');
        const profilePage = document.getElementById('profile-page');
        const quizPage = document.getElementById('quiz-page');
        const recommendationsPage = document.getElementById('recommendations-page');
        const subcategoryPage = document.getElementById('subcategory-page');
        const contentPage = document.getElementById('content-page');
        
        const quizContainer = document.getElementById('quiz-container');
        const progressBar = document.getElementById('progress-bar');
        const recommendationsGrid = document.getElementById('recommendations-grid');
        const subcategoryContainer = document.getElementById('subcategory-container');
        const contentContainer = document.getElementById('content-container');
        const appGrid = document.getElementById('app-grid');
        
        const loginBtn = document.getElementById('login-btn');
        const profileBtn = document.getElementById('profile-btn');
        const logoutBtns = document.querySelectorAll('.logout-btn');
        const backToDashboardBtns = document.querySelectorAll('.back-to-dashboard-btn');
        const backToSubcategoriesBtn = document.getElementById('back-to-subcategories-btn');
        const continueToDashboardBtn = document.getElementById('continue-to-dashboard-btn');

        const notificationsBtn = document.getElementById('notifications-btn');
        const notificationsPanel = document.getElementById('notifications-panel');
        const notificationDot = document.getElementById('notification-dot');
        const notificationList = document.getElementById('notification-list');

        const chatBubble = document.getElementById('chat-bubble');
        const chatWindow = document.getElementById('chat-window');
        const closeChatBtn = document.getElementById('close-chat-btn');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatMessages = document.getElementById('chat-messages');

        const completionModal = document.getElementById('completion-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const downloadSheetBtn = document.getElementById('download-sheet-btn');

        let currentAppId = null;
        let currentQuestionIndex = 0;
        let userScores = {};
        let completionStatus = {};

        // --- DATOS ---
        const apps = [
            { id: 'innovacion', icon: 'lightbulb', label: 'Innovación y Tecnología', subcategories: [
                { id: 'ia', label: 'Inteligencia Artificial', content: 'Descubre cómo la IA puede automatizar tareas, ofrecer análisis predictivos y personalizar la experiencia del cliente para impulsar el crecimiento.'},
                { id: 'agile', label: 'Metodologías Ágiles', content: 'Aprende a implementar Scrum y Kanban para mejorar la flexibilidad, acelerar los tiempos de entrega y fomentar la colaboración en tus equipos.'},
                { id: 'iot', label: 'Internet de las Cosas (IoT)', content: 'Explora cómo los dispositivos conectados pueden optimizar operaciones, recopilar datos valiosos y crear nuevos modelos de negocio.'},
                { id: 'blockchain', label: 'Blockchain y Web3', content: 'Entiende los fundamentos de la tecnología blockchain, los contratos inteligentes y las oportunidades de la web descentralizada.'}
            ]},
            { id: 'herramientas', icon: 'wrench', label: 'Herramientas y Sistemas', subcategories: [
                { id: 'project', label: 'Gestión de Proyectos', content: 'Compara y aprende a usar herramientas como Asana, Trello y Jira para mantener tus proyectos organizados y a tiempo.'},
                { id: 'comms', label: 'Comunicación de Equipos', content: 'Optimiza la colaboración con plataformas como Slack y Microsoft Teams, integrando canales, bots y videollamadas.'},
                { id: 'crm', label: 'CRM y Gestión de Clientes', content: 'Domina los sistemas de CRM como HubSpot o Salesforce para gestionar tu embudo de ventas y mejorar la relación con tus clientes.'}
            ]},
            { id: 'analisis', icon: 'area-chart', label: 'Análisis de Mercado', subcategories: [
                { id: 'competitors', label: 'Análisis Competitivo', content: 'Aprende a usar frameworks como el análisis FODA y las 5 Fuerzas de Porter para entender a tu competencia y encontrar tu nicho.'},
                { id: 'keywords', label: 'Investigación de Palabras Clave', content: 'Utiliza herramientas como Ahrefs o SEMrush para identificar las palabras clave que tus clientes potenciales están buscando.'},
                { id: 'surveys', label: 'Encuestas y Feedback', content: 'Diseña encuestas efectivas con SurveyMonkey o Google Forms para obtener retroalimentación valiosa y validar tus ideas.'}
            ]},
            { id: 'marketing', icon: 'megaphone', label: 'Marketing y Ventas', subcategories: [
                { id: 'seo', label: 'SEO y SEM', content: 'Domina las técnicas de optimización para motores de búsqueda (SEO) y marketing (SEM) para aumentar drásticamente tu visibilidad en línea.'},
                { id: 'social', label: 'Redes Sociales', content: 'Crea estrategias de contenido efectivas para construir una comunidad, interactuar con tu audiencia y convertir seguidores en clientes.'},
                { id: 'email', label: 'Email Marketing', content: 'Aprende a diseñar campañas de correo electrónico personalizadas que nutran a tus leads y fomenten la lealtad del cliente.'},
                { id: 'funnels', label: 'Embudos de Venta', content: 'Construye embudos de conversión automatizados que guíen a los usuarios desde el primer contacto hasta la compra final.'}
            ]},
            { id: 'mentoria', icon: 'users', label: 'Mentoría y Asesoramiento', subcategories: [
                { id: 'connect', label: 'Conectar con un Mentor', content: 'Navega nuestro directorio de mentores expertos y encuentra el adecuado para tu industria y etapa de crecimiento.'},
                { id: 'sessions', label: 'Sesiones Grupales', content: 'Participa en mesas redondas y talleres grupales para aprender de las experiencias y desafíos de otros emprendedores.'},
                { id: 'growth', label: 'Planes de Crecimiento', content: 'Trabaja con un asesor para desarrollar un plan de crecimiento estratégico y personalizado para tu negocio.'}
            ]},
            { id: 'networking', icon: 'network', label: 'Networking', subcategories: [
                { id: 'events', label: 'Eventos Virtuales', content: 'Accede a nuestro calendario de webinars, paneles y ferias virtuales para conectar con líderes de la industria.'},
                { id: 'forums', label: 'Foros de Discusión', content: 'Únete a conversaciones temáticas en nuestros foros para resolver dudas, compartir conocimientos y encontrar colaboradores.'},
                { id: 'alliances', label: 'Alianzas Estratégicas', content: 'Aprende a identificar y proponer colaboraciones estratégicas que beneficien a ambas partes y aceleren el crecimiento.'}
            ]},
            { id: 'finanzas', icon: 'landmark', label: 'Finanzas y Contabilidad', subcategories: [
                { id: 'flujo', label: 'identifica, categoriza y estable una estructura', content: 'Aprende a monitorear y optimizar tus entradas y salidas de dinero, un factor clave para la supervivencia y el crecimiento de cualquier negocio.'},
                { id: 'inversion', label: 'mejora y reduce tus costos', content: 'Descubre cómo preparar tu pitch, valorar tu empresa y navegar el proceso de recaudación de fondos con capitalistas de riesgo y ángeles inversores.'},
                { id: 'modeling', label: 'como usar una hoja de calculo', content: 'Construye modelos financieros sólidos en Excel o Google Sheets para proyectar el futuro de tu empresa y tomar decisiones informadas.'}
            ]},
             { id: 'calidad', icon: 'shield-check', label: 'Gestión de la Calidad', subcategories: [
                { id: 'iso', label: 'Normas ISO 9001', content: 'Comprende los principios de la norma ISO 9001 y cómo su implementación puede mejorar la eficiencia y la satisfacción del cliente.'},
                { id: 'sixsigma', label: 'Metodología Six Sigma', content: 'Aprende a utilizar el enfoque DMAIC (Definir, Medir, Analizar, Mejorar, Controlar) para reducir defectos y optimizar procesos.'},
                { id: 'kaizen', label: 'Mejora Continua (Kaizen)', content: 'Fomenta una cultura de mejora continua en tu organización, donde cada miembro del equipo contribuye con pequeñas mejoras constantes.'}
            ]},
        ];
        
        const quizData = [
            {
                question: "¿Cuál es tu principal objetivo en este momento?",
                answers: [
                    { text: "Lanzar una nueva idea o producto.", scores: ['innovacion', 'analisis'] },
                    { text: "Optimizar las operaciones de mi negocio actual.", scores: ['herramientas', 'calidad'] },
                    { text: "Hacer crecer mi base de clientes y ventas.", scores: ['marketing', 'networking'] },
                    { text: "Mejorar mis conocimientos y habilidades empresariales.", scores: ['mentoria', 'finanzas'] }
                ]
            },
            {
                question: "¿Cuál es tu mayor desafío?",
                answers: [
                    { text: "Desarrollar una estrategia clara y un plan de acción.", scores: ['analisis', 'mentoria'] },
                    { text: "La gestión de las finanzas y los recursos.", scores: ['finanzas'] },
                    { text: "Mantenerme al día con la tecnología.", scores: ['innovacion', 'herramientas'] },
                    { text: "Llegar a nuevos clientes y mercados.", scores: ['marketing', 'networking'] }
                ]
            },
            {
                question: "¿En qué área sientes que necesitas más apoyo?",
                answers: [
                    { text: "Tecnología y sistemas informáticos.", scores: ['herramientas', 'innovacion'] },
                    { text: "Marketing y estrategias de venta.", scores: ['marketing'] },
                    { text: "Gestión financiera y contabilidad.", scores: ['finanzas'] },
                    { text: "Procesos, calidad y eficiencia.", scores: ['calidad', 'mentoria'] }
                ]
            }
        ];

        const notifications = [
            { title: 'Nueva tarea asignada', body: 'Revisar la propuesta de marketing.', time: 'hace 5 min' },
            { title: 'Reunión programada', body: 'Reunión de equipo mañana a las 10 AM.', time: 'hace 1 hora' },
            { title: '¡Nuevo logro!', body: 'Has completado el módulo de Finanzas.', time: 'hace 3 horas' },
        ];
        let chatHistory = [];

        // --- LÓGICA DE NAVEGACIÓN Y QUIZ ---
        function showPage(pageToShow) {
            [loginPage, dashboardPage, profilePage, quizPage, recommendationsPage, subcategoryPage, contentPage].forEach(p => p.classList.add('hidden'));
            pageToShow.classList.remove('hidden');
        }

        function startQuiz() {
            currentQuestionIndex = 0;
            userScores = {};
            apps.forEach(app => userScores[app.id] = 0);
            renderQuestion();
            showPage(quizPage);
        }

        function renderQuestion() {
            const questionData = quizData[currentQuestionIndex];
            quizContainer.innerHTML = `
                <h3 class="text-xl font-semibold text-white mb-6">${questionData.question}</h3>
                <div class="space-y-4">
                    ${questionData.answers.map((answer, index) => `
                        <button class="answer-btn w-full text-left p-4 bg-cyan-500/10 rounded-lg hover:bg-cyan-500/20 transition-colors" data-scores='${JSON.stringify(answer.scores)}'>
                            ${answer.text}
                        </button>
                    `).join('')}
                </div>
            `;
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.addEventListener('click', handleAnswerClick);
            });
            const progress = ((currentQuestionIndex) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        function handleAnswerClick(event) {
            const scores = JSON.parse(event.currentTarget.dataset.scores);
            scores.forEach(score => userScores[score]++);
            
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                renderQuestion();
            } else {
                progressBar.style.width = '100%';
                calculateRecommendations();
            }
        }

        function calculateRecommendations() {
            const sortedScores = Object.entries(userScores).sort(([,a],[,b]) => b-a);
            const top3 = sortedScores.slice(0, 3);
            renderRecommendations(top3.map(item => item[0]));
            showPage(recommendationsPage);
        }

        function renderRecommendations(recommendedAppIds) {
            recommendationsGrid.innerHTML = '';
            recommendedAppIds.forEach(appId => {
                const appData = apps.find(a => a.id === appId);
                if (appData) {
                    const appElement = document.createElement('div');
                    appElement.className = 'flex flex-col items-center justify-center text-center p-4 bg-[#2a3650] rounded-lg shadow-md hover:bg-cyan-500/20 border border-transparent hover:border-cyan-500/50 transition-all duration-300 cursor-pointer aspect-square';
                    appElement.innerHTML = `<i data-lucide="${appData.icon}" class="w-10 h-10 sm:w-12 sm:h-12 mb-3 text-cyan-400"></i><span class="text-gray-300 text-xs sm:text-sm font-light">${appData.label}</span>`;
                    appElement.addEventListener('click', () => showSubcategoryPage(appData.id));
                    recommendationsGrid.appendChild(appElement);
                }
            });
            lucide.createIcons();
        }
        
        function showSubcategoryPage(appId) {
            currentAppId = appId;
            const app = apps.find(a => a.id === appId);
            if (!app) return;

            subcategoryContainer.innerHTML = `
                <div class="flex items-center gap-4 mb-8">
                    <i data-lucide="${app.icon}" class="w-12 h-12 text-cyan-400"></i>
                    <h2 class="text-3xl font-bold text-cyan-400">${app.label}</h2>
                </div>
                <div class="space-y-4">
                    ${app.subcategories.map(sub => `
                        <button class="subcategory-btn w-full text-left p-4 bg-cyan-500/10 rounded-lg hover:bg-cyan-500/20 transition-colors flex justify-between items-center" data-sub-id="${sub.id}">
                            <span>${sub.label}</span>
                            <i data-lucide="chevron-right" class="w-5 h-5"></i>
                        </button>
                    `).join('')}
                </div>
            `;
            
            document.querySelectorAll('.subcategory-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showContentPage(appId, btn.dataset.subId);
                });
            });

            showPage(subcategoryPage);
            lucide.createIcons();
        }

        function showContentPage(appId, subId) {
            const app = apps.find(a => a.id === appId);
            const subcategory = app?.subcategories.find(s => s.id === subId);
            if (subcategory) {
                contentContainer.innerHTML = `
                    <div class="flex items-center gap-4 mb-6">
                        <i data-lucide="${app.icon}" class="w-12 h-12 text-cyan-400"></i>
                        <h2 class="text-3xl font-bold text-cyan-400">${subcategory.label}</h2>
                    </div>
                    <p class="text-gray-300 text-lg leading-relaxed">${subcategory.content}</p>
                `;
                showPage(contentPage);
                lucide.createIcons();
                
                // Lógica de completado
                if(appId === 'finanzas') {
                    if (!completionStatus[appId]) {
                        completionStatus[appId] = {};
                    }
                    completionStatus[appId][subId] = true;
                    checkFinanceCompletion();
                }
            }
        }

        function checkFinanceCompletion() {
            const financeApp = apps.find(a => a.id === 'finanzas');
            const financeSubs = financeApp.subcategories.map(s => s.id);
            const completedSubs = completionStatus['finanzas'] ? Object.keys(completionStatus['finanzas']) : [];
            
            if (financeSubs.every(subId => completedSubs.includes(subId))) {
                completionModal.classList.remove('hidden');
                lucide.createIcons(); // Renderizar el ícono del modal
            }
        }

        function downloadSpreadsheet() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Fecha,Descripción,Ingreso,Gasto\n"
                + "2025-07-19,Venta de Producto A,1500,\n"
                + "2025-07-19,Pago de Software,-50,\n"
                + "2025-07-20,Consultoría,2500,\n"
                + "2025-07-21,Publicidad en Redes,-150,\n";
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "control_ingresos_gastos.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        loginBtn.addEventListener('click', startQuiz);
        continueToDashboardBtn.addEventListener('click', () => showPage(dashboardPage));
        profileBtn.addEventListener('click', () => showPage(profilePage));
        logoutBtns.forEach(btn => btn.addEventListener('click', () => showPage(loginPage)));
        backToDashboardBtns.forEach(btn => btn.addEventListener('click', () => showPage(dashboardPage)));
        backToSubcategoriesBtn.addEventListener('click', () => showSubcategoryPage(currentAppId));
        closeModalBtn.addEventListener('click', () => completionModal.classList.add('hidden'));
        downloadSheetBtn.addEventListener('click', downloadSpreadsheet);
        
        // --- LÓGICA DE NOTIFICACIONES ---
        notificationsBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            notificationsPanel.classList.toggle('hidden');
            notificationDot.classList.add('hidden');
        });
        document.addEventListener('click', (e) => {
            if (!notificationsPanel.contains(e.target) && !notificationsBtn.contains(e.target)) {
                notificationsPanel.classList.add('hidden');
            }
        });
        function renderNotifications() {
            notificationList.innerHTML = '';
            notifications.forEach(n => {
                const item = document.createElement('div');
                item.className = 'p-3 hover:bg-cyan-500/10 rounded-md cursor-pointer border-b border-cyan-500/10';
                item.innerHTML = `<p class="font-semibold text-sm text-cyan-400">${n.title}</p><p class="text-xs text-gray-300">${n.body}</p><p class="text-xs text-cyan-400/50 text-right mt-1">${n.time}</p>`;
                notificationList.appendChild(item);
            });
        }

        // --- LÓGICA DEL CHATBOT CON GEMINI ---
        function addMessageToChat(text, sender) {
            const messageElement = document.createElement('div');
            if (sender === 'bot-loading') {
                messageElement.className = 'bg-gray-600/50 text-gray-200 p-3 rounded-lg self-start bot-loading';
                messageElement.innerHTML = `<div class="flex items-center space-x-2"><div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse-dot"></div><div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse-dot"></div><div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse-dot"></div></div>`;
            } else {
                messageElement.textContent = text;
                messageElement.className = sender === 'user' ? 'bg-cyan-500 text-white p-3 rounded-lg self-end max-w-[80%] break-words' : 'bg-gray-600/50 text-gray-200 p-3 rounded-lg self-start max-w-[80%] break-words';
            }
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function getGeminiResponse(prompt) {
            addMessageToChat('', 'bot-loading');
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
                const result = await response.json();
                const loadingElement = document.querySelector('.bot-loading');
                if (loadingElement) loadingElement.remove();
                if (result.candidates && result.candidates.length > 0) {
                    const botResponse = result.candidates[0].content.parts[0].text;
                    addMessageToChat(botResponse, 'bot');
                    chatHistory.push({ role: "model", parts: [{ text: botResponse }] });
                } else {
                    addMessageToChat('Lo siento, no pude procesar tu solicitud.', 'bot');
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                const loadingElement = document.querySelector('.bot-loading');
                if (loadingElement) loadingElement.remove();
                addMessageToChat('Hubo un error al conectar con mis circuitos. Intenta de nuevo.', 'bot');
            }
        }

        async function processUserCommand(command) {
            const lowerCaseCommand = command.toLowerCase();
            const localCommands = {
                'perfil': { response: "Claro, te llevo a tu perfil.", action: () => showPage(profilePage) },
                'panel': { response: "Entendido, volviendo al panel principal.", action: () => showPage(dashboardPage) },
                'inicio': { response: "Entendido, volviendo al panel principal.", action: () => showPage(dashboardPage) },
                'sesión': { response: "Cerrando sesión. ¡Hasta pronto!", action: () => showPage(loginPage) },
                'salir': { response: "Cerrando sesión. ¡Hasta pronto!", action: () => showPage(loginPage) },
                'ayuda': { response: "¡Hola! Soy Innovabot. Puedes hacerme preguntas o usar comandos como 'perfil', 'panel', 'cerrar sesión' o 'abrir [tema]'.", action: () => {} }
            };
            let commandHandled = false;
            for (const key in localCommands) {
                if (lowerCaseCommand.includes(key)) {
                    addMessageToChat(localCommands[key].response, 'bot');
                    setTimeout(localCommands[key].action, 500);
                    commandHandled = true;
                    break;
                }
            }
            if (!commandHandled) {
                const foundApp = apps.find(a => lowerCaseCommand.includes(a.id));
                if (foundApp) {
                    addMessageToChat(`Entendido, abriendo ${foundApp.label}.`, 'bot');
                    setTimeout(() => showSubcategoryPage(foundApp.id), 500);
                    commandHandled = true;
                }
            }
            if (!commandHandled) {
                await getGeminiResponse(command);
            }
        }

        chatBubble.addEventListener('click', () => {
            chatWindow.classList.toggle('hidden');
            if (!chatWindow.classList.contains('hidden') && chatMessages.children.length === 0) { 
                addMessageToChat("¡Hola! Soy Innovabot. ¿En qué puedo ayudarte hoy?", 'bot'); 
            }
        });
        closeChatBtn.addEventListener('click', () => { chatWindow.classList.add('hidden'); });
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (userInput) {
                addMessageToChat(userInput, 'user');
                chatInput.value = '';
                await processUserCommand(userInput);
            }
        });

        // --- RENDERIZADO DINÁMICO ---
        function renderApps() {
            appGrid.innerHTML = '';
            apps.forEach(app => {
                const appElement = document.createElement('div');
                appElement.className = 'flex flex-col items-center justify-center text-center p-4 bg-[#2a3650] rounded-lg shadow-md hover:bg-cyan-500/20 border border-transparent hover:border-cyan-500/50 transition-all duration-300 cursor-pointer aspect-square';
                appElement.innerHTML = `<i data-lucide="${app.icon}" class="w-10 h-10 sm:w-12 sm:h-12 mb-3 text-cyan-400"></i><span class="text-gray-300 text-xs sm:text-sm font-light">${app.label}</span>`;
                appElement.addEventListener('click', () => showSubcategoryPage(app.id));
                appGrid.appendChild(appElement);
            });
        }

        // --- INICIALIZACIÓN ---
        function initializeApp() {
            renderApps();
            renderNotifications();
            lucide.createIcons();
            chatHistory.push(
                { role: "user", parts: [{ text: "You are Innovabot, a helpful and futuristic assistant for the Innovamind platform. Be concise and helpful. Your answers should be in Spanish." }] },
                { role: "model", parts: [{ text: "Entendido. Soy Innovabot. ¿Cómo puedo ayudarte a innovar hoy?" }] }
            );
            document.getElementById('dashboard-title').textContent = 'Cursos';
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
