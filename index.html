<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercado Local - Prototipo</title>
    
    <!-- Tailwind CSS para un diseño rápido y moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts para una tipografía más agradable -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Usamos la fuente Inter que importamos */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Pequeña transición para los cambios de vista */
        .view {
            display: none;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- BARRA DE NAVEGACIÓN PRINCIPAL -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="#" onclick="showView('homeView')" class="flex-shrink-0 text-xl font-bold text-blue-600">
                        MercadoLocal
                    </a>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#" onclick="showView('homeView')" class="text-gray-600 hover:bg-gray-200 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">Inicio</a>
                        <a href="#" onclick="showView('coursesView')" class="text-gray-600 hover:bg-gray-200 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">Cursos</a>
                        
                        <!-- Botones que cambian según el estado de sesión -->
                        <a href="#" id="nav-my-profile" onclick="showView('myProfileView')" class="hidden text-gray-600 hover:bg-gray-200 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">Mi Perfil</a>
                        <a href="#" id="nav-register" onclick="showView('registerView')" class="bg-blue-500 text-white hover:bg-blue-600 px-3 py-2 rounded-md text-sm font-medium">Regístra tu Negocio</a>
                        <a href="#" id="nav-logout" onclick="logout()" class="hidden bg-red-500 text-white hover:bg-red-600 px-3 py-2 rounded-md text-sm font-medium">Cerrar Sesión</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <!-- Menú móvil (simplificado por ahora) -->
                    <button onclick="showView('homeView')" class="text-gray-600 p-2">Inicio</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- CONTENEDOR PRINCIPAL DE VISTAS -->
    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">

        <!-- VISTA 1: INICIO (LISTA DE NEGOCIOS) -->
        <div id="homeView" class="view">
            <h1 class="text-3xl font-bold mb-6 px-4">Negocios Locales</h1>
            <div id="business-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4">
                <!-- Las tarjetas de negocios se insertarán aquí con JavaScript -->
            </div>
        </div>

        <!-- VISTA 2: REGISTRO DE NEGOCIO -->
        <div id="registerView" class="view">
            <div class="max-w-md mx-auto bg-white p-8 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold mb-6 text-center">Crea tu cuenta</h2>
                <form id="register-form">
                    <div class="mb-4">
                        <label for="business-name" class="block text-sm font-medium text-gray-700">Nombre del Negocio</label>
                        <input type="text" id="business-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div class="mb-4">
                        <label for="business-email" class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
                        <input type="email" id="business-email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div class="mb-6">
                        <label for="business-password" class="block text-sm font-medium text-gray-700">Contraseña</label>
                        <input type="password" id="business-password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 font-semibold">Registrarse</button>
                </form>
            </div>
        </div>

        <!-- VISTA 3: PERFIL PÚBLICO DE UN NEGOCIO -->
        <div id="sellerProfileView" class="view">
            <!-- El contenido se genera dinámicamente con JS -->
        </div>

        <!-- VISTA 4: MI PERFIL (EDITABLE) -->
        <div id="myProfileView" class="view">
             <div class="bg-white p-8 rounded-lg shadow-lg">
                <h2 class="text-3xl font-bold mb-2">Mi Perfil</h2>
                <p class="mb-6 text-gray-500">Aquí puedes editar la información de tu negocio y gestionar tu catálogo.</p>
                
                <!-- Formulario para editar perfil -->
                <form id="edit-profile-form" class="mb-8 border-b pb-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                           <label for="edit-business-name" class="block text-sm font-medium text-gray-700">Nombre del Negocio</label>
                           <input type="text" id="edit-business-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                        </div>
                        <div>
                           <label for="edit-business-phone" class="block text-sm font-medium text-gray-700">Teléfono (WhatsApp)</label>
                           <input type="tel" id="edit-business-phone" placeholder="Ej: 5216641234567" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="edit-business-description" class="block text-sm font-medium text-gray-700">Descripción del Negocio</label>
                        <textarea id="edit-business-description" rows="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"></textarea>
                    </div>
                    <div class="mt-6">
                        <button type="submit" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 font-semibold">Guardar Cambios</button>
                    </div>
                </form>

                <!-- Sección de Catálogo -->
                <h3 class="text-2xl font-bold mt-8 mb-4">Mi Catálogo</h3>
                <div id="my-catalog-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Productos del usuario -->
                </div>

                <!-- Formulario para añadir nuevo producto -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h4 class="text-xl font-bold mb-4">Añadir Nuevo Producto</h4>
                    <form id="add-product-form">
                        <div class="mb-4">
                            <label for="product-name" class="block text-sm font-medium text-gray-700">Nombre del Producto</label>
                            <input type="text" id="product-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md" required>
                        </div>
                        <div class="mb-4">
                            <label for="product-price" class="block text-sm font-medium text-gray-700">Precio (MXN)</label>
                            <input type="number" id="product-price" step="0.01" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md" required>
                        </div>
                        <div class="mb-4">
                            <label for="product-image" class="block text-sm font-medium text-gray-700">URL de la Imagen</label>
                            <input type="url" id="product-image" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="https://ejemplo.com/imagen.jpg">
                        </div>
                        <button type="submit" class="w-full md:w-auto bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 font-semibold">Añadir Producto</button>
                    </form>
                </div>
             </div>
        </div>
        
        <!-- VISTA 5: CURSOS -->
        <div id="coursesView" class="view">
            <div class="bg-white p-8 rounded-lg shadow-lg text-center">
                <h2 class="text-3xl font-bold mb-4">Próximamente: Cursos</h2>
                <p class="text-gray-600">Estamos preparando una sección de cursos para ayudarte a potenciar tu negocio. ¡Vuelve pronto!</p>
                 <img src="https://placehold.co/600x400/3B82F6/FFFFFF?text=Cursos+en+Construcción" alt="Cursos en construcción" class="mx-auto mt-6 rounded-lg">
            </div>
        </div>

    </main>

    <script>
        // --- SIMULACIÓN DE BASE DE DATOS Y ESTADO DE LA APP ---

        // Datos de ejemplo para los negocios
        let businesses = [
            {
                id: 1,
                name: 'Frutería "La Cosecha"',
                email: 'fruteria@test.com',
                password: '123',
                description: 'Las frutas y verduras más frescas de la región, directo del campo a tu mesa. Ofrecemos servicio a domicilio.',
                phone: '5216641112233',
                catalog: [
                    { id: 101, name: 'Kilo de Manzana Gala', price: 45.50, image: 'https://placehold.co/400x300/f87171/ffffff?text=Manzanas' },
                    { id: 102, name: 'Kilo de Plátano', price: 25.00, image: 'https://placehold.co/400x300/facc15/ffffff?text=Plátanos' },
                    { id: 103, name: 'Canasta de Verduras', price: 150.00, image: 'https://placehold.co/400x300/4ade80/ffffff?text=Verduras' }
                ]
            },
            {
                id: 2,
                name: 'Artesanías "Corazón Mexicano"',
                email: 'artesanias@test.com',
                password: '123',
                description: 'Piezas únicas hechas a mano por artesanos locales. Alebrijes, textiles y cerámica de alta calidad.',
                phone: '5215554443322',
                catalog: [
                    { id: 201, name: 'Alebrije de Colores', price: 850.00, image: 'https://placehold.co/400x300/c084fc/ffffff?text=Alebrije' },
                    { id: 202, name: 'Jarrón de Talavera', price: 1200.00, image: 'https://placehold.co/400x300/60a5fa/ffffff?text=Jarrón' },
                ]
            }
        ];

        // Variable para guardar el usuario que ha iniciado sesión
        let currentUser = null;

        // --- LÓGICA DE NAVEGACIÓN Y VISTAS ---

        const views = document.querySelectorAll('.view');
        
        function showView(viewId) {
            views.forEach(view => {
                if (view.id === viewId) {
                    view.style.display = 'block';
                } else {
                    view.style.display = 'none';
                }
            });
            // Lógica específica al mostrar una vista
            if (viewId === 'homeView') renderBusinessList();
            if (viewId === 'myProfileView' && currentUser) renderMyProfile();
        }

        // --- RENDERIZADO DE CONTENIDO DINÁMICO ---

        function renderBusinessList() {
            const listContainer = document.getElementById('business-list');
            listContainer.innerHTML = ''; // Limpiar lista
            businesses.forEach(business => {
                const card = `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden transform hover:scale-105 transition-transform duration-300 cursor-pointer" onclick="showSellerProfile(${business.id})">
                        <img src="${business.catalog[0]?.image || 'https://placehold.co/400x300/e0e0e0/333333?text=Negocio'}" alt="Imagen de ${business.name}" class="w-full h-48 object-cover">
                        <div class="p-4">
                            <h3 class="text-lg font-bold">${business.name}</h3>
                            <p class="text-gray-600 text-sm mt-1 truncate">${business.description}</p>
                            <button class="mt-4 w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 text-sm font-semibold">Ver Perfil</button>
                        </div>
                    </div>
                `;
                listContainer.innerHTML += card;
            });
        }
        
        function showSellerProfile(businessId) {
            const business = businesses.find(b => b.id === businessId);
            if (!business) return;

            const profileContainer = document.getElementById('sellerProfileView');
            let catalogHTML = '';
            business.catalog.forEach(item => {
                catalogHTML += `
                    <div class="border rounded-lg p-4 bg-white">
                        <img src="${item.image || 'https://placehold.co/400x300/e0e0e0/333333?text=Producto'}" alt="${item.name}" class="w-full h-40 object-cover rounded-md mb-4">
                        <h4 class="font-bold text-md">${item.name}</h4>
                        <p class="text-green-600 font-semibold text-lg">$${item.price.toFixed(2)}</p>
                    </div>
                `;
            });
            
            const whatsappLink = `https://wa.me/${business.phone}?text=Hola,%20me%20interesan%20tus%20productos.`;

            profileContainer.innerHTML = `
                <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                    <button onclick="showView('homeView')" class="mb-4 text-blue-600 hover:underline">&larr; Volver a la lista</button>
                    <h2 class="text-4xl font-extrabold mb-2">${business.name}</h2>
                    <p class="text-gray-600 mb-6">${business.description}</p>
                    <a href="${whatsappLink}" target="_blank" class="inline-block bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600 transition-colors">
                        Contactar por WhatsApp
                    </a>
                    
                    <h3 class="text-2xl font-bold mt-10 mb-4 border-t pt-6">Catálogo de Productos</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${catalogHTML || '<p>Este negocio aún no tiene productos en su catálogo.</p>'}
                    </div>
                </div>
            `;
            showView('sellerProfileView');
        }

        function renderMyProfile() {
            if (!currentUser) return;
            // Rellenar formulario de edición
            document.getElementById('edit-business-name').value = currentUser.name;
            document.getElementById('edit-business-phone').value = currentUser.phone || '';
            document.getElementById('edit-business-description').value = currentUser.description || '';
            
            // Renderizar catálogo personal
            const myCatalogContainer = document.getElementById('my-catalog-list');
            myCatalogContainer.innerHTML = '';
            currentUser.catalog.forEach(item => {
                const productCard = `
                    <div class="border rounded-lg p-4 bg-white relative">
                        <img src="${item.image || 'https://placehold.co/400x300/e0e0e0/333333?text=Producto'}" class="w-full h-32 object-cover rounded-md mb-2">
                        <h4 class="font-bold text-md">${item.name}</h4>
                        <p class="text-green-600 font-semibold">$${item.price.toFixed(2)}</p>
                        <button onclick="removeProduct(${item.id})" class="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full hover:bg-red-600 flex items-center justify-center">&times;</button>
                    </div>
                `;
                myCatalogContainer.innerHTML += productCard;
            });
        }

        // --- MANEJO DE FORMULARIOS Y EVENTOS ---

        document.getElementById('register-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('business-name').value;
            const email = document.getElementById('business-email').value;
            const password = document.getElementById('business-password').value;
            
            const newBusiness = {
                id: Date.now(), // ID único simple
                name,
                email,
                password,
                description: '¡Bienvenido! Edita tu descripción desde la sección "Mi Perfil".',
                phone: '',
                catalog: []
            };
            
            businesses.push(newBusiness);
            currentUser = newBusiness;
            
            this.reset();
            updateUI();
            showView('myProfileView');
        });

        document.getElementById('edit-profile-form').addEventListener('submit', function(e) {
            e.preventDefault();
            if(!currentUser) return;
            currentUser.name = document.getElementById('edit-business-name').value;
            currentUser.phone = document.getElementById('edit-business-phone').value;
            currentUser.description = document.getElementById('edit-business-description').value;
            alert('Perfil actualizado con éxito!');
            renderBusinessList(); // Actualizar la lista por si cambió el nombre o descripción
        });
        
        document.getElementById('add-product-form').addEventListener('submit', function(e) {
            e.preventDefault();
            if(!currentUser) return;
            
            const newProduct = {
                id: Date.now(),
                name: document.getElementById('product-name').value,
                price: parseFloat(document.getElementById('product-price').value),
                image: document.getElementById('product-image').value
            };
            
            currentUser.catalog.push(newProduct);
            this.reset();
            renderMyProfile(); // Actualizar la vista del catálogo
        });

        function removeProduct(productId) {
            if(!currentUser) return;
            const confirmation = confirm('¿Estás seguro de que quieres eliminar este producto?');
            if (confirmation) {
                currentUser.catalog = currentUser.catalog.filter(p => p.id !== productId);
                renderMyProfile();
            }
        }

        // --- LÓGICA DE AUTENTICACIÓN (SIMULADA) ---

        function updateUI() {
            const navMyProfile = document.getElementById('nav-my-profile');
            const navRegister = document.getElementById('nav-register');
            const navLogout = document.getElementById('nav-logout');

            if (currentUser) {
                navMyProfile.style.display = 'block';
                navLogout.style.display = 'block';
                navRegister.style.display = 'none';
            } else {
                navMyProfile.style.display = 'none';
                navLogout.style.display = 'none';
                navRegister.style.display = 'block';
            }
        }
        
        function logout() {
            currentUser = null;
            updateUI();
            showView('homeView');
        }

        // --- INICIALIZACIÓN DE LA APP ---
        
        window.onload = () => {
            updateUI();
            showView('homeView');
        };

    </script>
</body>
</html>
